#! /bin/bash
printf "*************SHELL: $SHELL*************\n"
#global variables
filePath=tempFile$$
numRows=0
numCols=0


# validateMatrix()
# parameter(s): File containing matrix to be verified
# function: Check matrix to assure requirements:
#   1. File is readable
#   2. Tab-delimited table
#   3. Must contain at least one element
#   4. Each element must be a signed int and defined
#   5. Table must be rectangular
#   6. Must not allow:
#           - empty matrix
#           - matrix where final entry on a row is a tab character
#           - matrix with empty lines
#           - matrix with any element that is blank or not an int
# output: If matrix is valid, there is no output and the program will resume with
#         executing the user command. 
#         If matrix is invalid then:
#                   - output an error message to stderr
#                   - return value should be non-zero
validateMatrix(){
    printf "validating matrix\n"
}

# dims()
# parameter(s): A matrix of integers which can be contained in a file or entered via stdin    
# function: Calculates the dimensions of the matrix
# output: Number of rows and the number of columns separated by a single space to stdout 
#         and return 0
# error handling: Print error message to stderr and return/exit 1
#       In the event that:
#           - argument count is  > 1
#           - file containing matrix cannot be read
dims(){
    #printf "dims called with arg: $1\n"
    colCnt=0
    while read numLine
        do
        for i in $numLine
            do
            colCnt=$(expr $colCnt + 1)
        done

        if [ $numCols -le 0 ]
            then
            numCols=$colCnt
        #printf "numCols set to $numCols\n"
        elif [ $colCnt -ne $numCols ]
            then
            printf "Error - invalid matrix\n"
            exit 1
        fi
        colCnt=0
        numRows=$(expr $numRows + 1)
    done <${1:-/dev/stdin}
    printf "$numRows $numCols\n"
}

# transpose()
# parameter(s): A matrix of integers which can be contained in a file or entered via stdin
# function: Relects matrix along the main diagnol. MxN => NxM
# output: Output the new matrix to stdout and return 0
# error handling: Print error message to stderr and return/exit 1
#       In the event that:
#           - argument count is  > 1
#           - file containing matrix cannot be read
transpose(){
    printf "transpose called with arg: $1\n"
}

# mean() 
# parameter(s): A matrix of integers which can be contained in a file or entered via stdin
# function: Calculates the mean of the values for each column in the matrix
# output: Output the mean values for each row to stdout and return 0
# error handling: Print error message to stderr and return/exit 1
#       In the event that:
#           - argument count is  > 1
#           - file containing matrix cannot be read
mean(){
    printf "mean called with arg: $1\n"
}

# add()
# parameter(s): Two matrices contained within files   
# function: Adds the two matrices element wise to produce another matrix
# output: Output the new matrix containing all the sum values to stdout 
#         and return 0
# error handling: Print error message to stderr and return/exit 1
#       In the event that:
#           - argument count is != 2
#           - either file containing a matrix cannot be read
#           - the dimensions of the input matrices do not allow them to be 
#             added together following the rules of matrix addition
add(){
    printf "add called with arg1: $1, arg2: $2\n"
}

# multiply() operation call - 
# parameter(s):    
# function: 
# output: 
# error handling: Print error message to stderr and return/exit 1
#       In the event that:
#           - argument count is != 2
#           - either file containing a matrix cannot be read
#           - the dimensions of the input matrices do not allow them to be 
#             multiplied together following the rules of matrix multiplication
multiply(){
    printf "add called with arg1: $1, arg2: $2\n"
}

#operation == dims or transpose or mean
if [ $1 = "dims" ] || [ $1 = "transpose" ] || [ $1 = "mean" ]
    then
    echo -e "arg1: $1\targ2: $2\t argc: $#"
    #if user tries to pass more than two args to the above three operations
    if [ $# -gt 2 ]
        #handle error
        then
        #error message redirected from stdout to stderr
        echo -e "Error executing $1 - invalid number of arguments" 
        exit 1
    #three args total ($2 contains file name to be passed to operation) 
    elif [ $# = 2 ]
        then
        $1 $2
    #two args total => means no file name passed => which means read from stdin
    else
        cat > $filePath
        $1 tempFile$$
        rm -f tempFile$$
    fi
fi

#$1 ${@:2}

